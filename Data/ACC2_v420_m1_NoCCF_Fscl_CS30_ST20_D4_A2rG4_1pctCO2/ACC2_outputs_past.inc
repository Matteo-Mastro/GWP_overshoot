********** ACC2 version 4.2: ACC2_outputs_past.inc *********************************************************************
********** File output to display results (past mode) ==================================================================

*** Display the status of inversion results ----------------------------------------------------------------------------

DISPLAY PAST.MODELSTAT;
DISPLAY PAST.SOLVESTAT;
DISPLAY CF.l;


*** Generate graphical output ------------------------------------------------------------------------------------------

$ontext
PARAMETERS

OUTPUT(*,T,*);

loop (T,
OUTPUT('POSTERIOR',T,'YEAR') = 1749+Ord(T);
OUTPUT('POSTERIOR',T,'T2M') = T2M.L(T);
OUTPUT('MEASUREMENTS',T,'YEAR') = 1749+Ord(T);
OUTPUT('MEASUREMENTS',T,'T2M') = T2MPRI.L(T);
);

$SETGLOBAL GP_TITLE  "Global-annual-mean temperature change"
$SETGLOBAL GP_XLABEL "Year"
$SETGLOBAL GP_YLABEL "Degree in C"
$SETGLOBAL GP_XRANGE '1750:2000'
$SETGLOBAL GP_YRANGE '-1.0:1.5'

$libinclude gnupltxy OUTPUT YEAR T2M
$offtext

*** File output to summarize the inversion results ---------------------------------------------------------------------

FILE OUT_PAST_INV /out_past_inv.dat/;
OUT_PAST_INV.AP=0;
PUT OUT_PAST_INV;
PUT 'CF', @25, CF.L:10:3//;

PUT 'CO2FFRESSUM', @25, CO2FFRESSUM.L:10:3/;
PUT 'CO2LURESSUM', @25, CO2LURESSUM.L:10:3/;
PUT 'ANTRESSUMCH4', @25, ANTRESSUMCH4.L:10:3/;
PUT 'ANTRESSUMN2O', @25, ANTRESSUMN2O.L:10:3/;
PUT 'RADMISRESSUM', @25, RADMISRESSUM.L:10:3/;

PUT 'TMIX1750RESSUM', @25, TMIX1750RESSUM.L:10:3/;
PUT 'DMPTMIXRESSUM', @25, DMPTMIXRESSUM.L:10:3/;
PUT 'BETARESSUM', @25, BETARESSUM.L:10:3/;
PUT 'Q10BASRESSUM', @25, Q10BASRESSUM.L:10:3/;
PUT 'Q10TMPRESSUM', @25, Q10TMPRESSUM.L:10:3/;
PUT 'TNPPSENSRESSUM', @25, TNPPSENSRESSUM.L:10:3/;
PUT 'CO2OCNUPPRERESSUM', @25, CO2OCNUPPRERESSUM.L:10:3/;
PUT 'CO2LNDUPPRERESSUM', @25, CO2LNDUPPRERESSUM.L:10:3/;
PUT 'NATCH4RESSUM', @25, NATCH4RESSUM.L:10:3/;
PUT 'NATN2ORESSUM', @25, NATN2ORESSUM.L:10:3/;
PUT 'TAUCH4OHRESSUM', @25, TAUCH4OHRESSUM.L:10:3/;
PUT 'TAUN2ORESSUM', @25, TAUN2ORESSUM.L:10:3/;
PUT 'RAD2XCO2RESSUM', @25, RAD2XCO2RESSUM.L:10:3/;
PUT 'SCLRADRESSUM', @25, SCLRADRESSUM.L:10:3/;
PUT 'SENSRESSUM', @25, SENSRESSUM.L:10:3/;
PUT 'KAPPARESSUM', @25, KAPPARESSUM.L:10:3/;
PUT 'RADMISAR1PRORESSUM', @25, RADMISAR1PRORESSUM.L:10:3/;
PUT 'T2MAR1PRORESSUM', @25, T2MAR1PRORESSUM.L:10:3//;

PUT 'CO2OCNUPANTRESSUM', @25, CO2OCNUPANTRESSUM.L:10:3/;
PUT 'CO2LNDUPANTRESSUM', @25, CO2LNDUPANTRESSUM.L:10:3/;
PUT 'CONCO2RESSUM', @25, CONCO2RESSUM.L:10:3/;
PUT 'CONCH4RESSUM', @25, CONCH4RESSUM.L:10:3/;
PUT 'CONN2ORESSUM', @25, CONN2ORESSUM.L:10:3/;
PUT 'T2MRESSUM', @25, T2MRESSUM.L:10:3//;

PUT 'TMIX1750', @25, TMIX1750.L:10:3/;
PUT 'DMPTMIX', @25, DMPTMIX.L:10:3/;
PUT 'BETA', @25, BETA.L('2000'):10:3/;
PUT 'Q10BAS', @25, Q10BAS.L:10:3/;
PUT 'Q10TMP', @25, Q10TMP.L:10:3/;
PUT 'TNPPSENS', @25, TNPPSENS.L:10:3/;
PUT 'CO2OCNUPPRE', @25, CO2OCNUPPRE.L('2000'):10:3/;
PUT 'CO2LNDUPPRE', @25, CO2LNDUPPRE.L('2000'):10:3/;
PUT 'NATCH4', @25, NATCH4.L:10:3/;
PUT 'NATN2O', @25, NATN2O.L:10:3/;
PUT 'TAUCH4OH', @25, TAUCH4OH.L:10:3/;
PUT 'TAUN2O', @25, TAUN2O.L:10:3/;
PUT 'RAD2XCO2', @25, RAD2XCO2.L:10:3/;
PUT 'SCLRAD', @25, SCLRAD.L:10:3/;
PUT 'SENS', @25, SENS.L('2000'):10:3/;
PUT 'KAPPA', @25, KAPPA.L:10:3/;
PUT 'RADMISAR1PRO', @25, RADMISAR1PRO.L:10:3/;
PUT 'T2MAR1PRO', @25, T2MAR1PRO.L:10:3//;

PUT 'RADAERAVE', @25, RADAERAVE.L:10:3/;
PUT 'RADMISAVE', @25, RADMISAVE.L:10:3/;
PUT 'YINTRCO2ENSO', @25, YINTRCO2ENSO.L:10:3/;
PUT 'SLOPECO2ENSO', @25, SLOPECO2ENSO.L:10:3/;
PUT 'RSQ1', @25, RSQ1.L:10:3/;
PUT 'RSQ2', @25, RSQ2.L:10:3//;

PUT 'MODELSTAT', @25, PAST.MODELSTAT:10:0/;
PUT 'SOLVESTAT', @25, PAST.SOLVESTAT:10:0/;
PUT 'NUMEQU', @25, PAST.NUMEQU:10:0/;
PUT 'NUMINFES', @25, PAST.NUMINFES:10:0/;
PUT 'NUMNOPT', @25, PAST.NUMNOPT:10:0/;
PUT 'NUMNZ', @25, PAST.NUMNZ:10:0/;
PUT 'NUMVAR', @25, PAST.NUMVAR:10:0/;
PUT 'ITERUSD', @25, PAST.ITERUSD:10:0/;
PUT 'RESUSD', @25, PAST.RESUSD:10:3//;

PUT 'CO2FFSWCH', @25, CO2FFSWCH:10:0/;
PUT 'CO2LUSWCH', @25, CO2LUSWCH:10:0/;
PUT 'ANTCH4N2OSWCH', @25, ANTCH4N2OSWCH:10:0/;
PUT 'RADMISSWCH', @25, RADMISSWCH:10:0/;

PUT 'TMIX1750SWCH', @25, TMIX1750SWCH:10:0/;
PUT 'DMPTMIXSWCH', @25, DMPTMIXSWCH:10:0/;
PUT 'BETASWCH', @25, BETASWCH:10:0/;
PUT 'Q10BASSWCH', @25, Q10BASSWCH:10:0/;
PUT 'Q10TMPSWCH', @25, Q10TMPSWCH:10:0/;
PUT 'TNPPSENSSWCH', @25, TNPPSENSSWCH:10:0/;
PUT 'CO2OCNUPPRESWCH', @25, CO2OCNUPPRESWCH:10:0/;
PUT 'CO2LNDUPPRESWCH', @25, CO2LNDUPPRESWCH:10:0/;
PUT 'NATCH4N2OSWCH', @25, NATCH4N2OSWCH:10:0/;
PUT 'TAUCH4N2OSWCH', @25, TAUCH4N2OSWCH:10:0/;
PUT 'RAD2XCO2SWCH', @25, RAD2XCO2SWCH:10:0/;
PUT 'SCLRADSWCH', @25, SCLRADSWCH:10:0/;
PUT 'SENSSWCH', @25, SENSSWCH:10:0/;
PUT 'KAPPASWCH', @25, KAPPASWCH:10:0/;
PUT 'RADMISAR1PROSWCH', @25, RADMISAR1PROSWCH:10:0/;
PUT 'T2MAR1PROSWCH', @25, T2MAR1PROSWCH:10:0/;

PUT 'CO2UPANTSWCH', @25, CO2UPANTSWCH:10:0/;
PUT 'CONCO2SWCH', @25, CONCO2SWCH:10:0/;
PUT 'CONCH4N2OSWCH', @25, CONCH4N2OSWCH:10:0/;
PUT 'T2MSWCH', @25, T2MSWCH:10:0/;

PUT 'DOECLIMSWCH', @25, DOECLIMSWCH:10:0/;

PUT 'DYNCARBSWCH', @25, DYNCARBSWCH:10:0/;
PUT 'OCNCO2TFSWCH', @25, OCNCO2TFSWCH:10:0/;
PUT 'LNDCO2TFNPPSWCH', @25, LNDCO2TFNPPSWCH:10:0/;
PUT 'LNDCO2TFRESSWCH', @25, LNDCO2TFRESSWCH:10:0/;
PUT 'LNDCO2TFQ10SWCH', @25, LNDCO2TFQ10SWCH:10:0/;
PUT 'CO2UPPRESWCH', @25, CO2UPPRESWCH:10:0/;

PUT 'CO2LUSGMSWCH', @25, CO2LUSGMSWCH:10:0/;
PUT 'CONCO2SGMSWCH', @25, CONCO2SGMSWCH:10:0/;
PUT 'ANTCH4N2OSGMSWCH', @25, ANTCH4N2OSGMSWCH:10:0/;
PUT 'CONCH4SGMSWCH', @25, CONCH4SGMSWCH:10:0/;
PUT 'CONN2OSGMSWCH', @25, CONN2OSGMSWCH:10:0/;
PUT 'ENSOCO2SWCH', @25, ENSOCO2SWCH:10:0/;
PUT 'ENSOT2MSWCH', @25, ENSOT2MSWCH:10:0/;
PUT 'RADMISAR1SWCH', @25, RADMISAR1SWCH:10:0/;
PUT 'T2MAR1SWCH', @25, T2MAR1SWCH:10:0/;
PUT 'VOLSWCH', @25, VOLSWCH:10:0/;

PUT 'MISTRNSWCH', @25, MISTRNSWCH:10:0/;
PUT 'SOLSWCH', @25, SOLSWCH:10:0/;


*** File outputs to display results-------------------------------------------------------------------------------------

FILE OUT_PAST /out_past.dat/;
OUT_PAST.AP=0;
OUT_PAST.PW=1000;
PUT OUT_PAST;
PUT
'YEAR ',
'CO2FFPRI ',
'CO2FFSGMMOD ',
'CO2FFPOS ',
'CO2FFRES ',
'CO2LUPRI ',
'CO2LUSGMMOD ',
'CO2LUPOS ',
'CO2LURES ',
'CONCO2PRI ',
'CONCO2SGMMOD ',
'CONCO2POS ',
'CONCO2RES ',
'OCNCO2UPPRI ',
'OCNCO2UPSGM ',
'OCNCO2UPPOS ',
'OCNCO2UPRES ',
'LNDCO2UPPRI ',
'LNDCO2UPSGM ',
'LNDCO2UPPOS ',
'LNDCO2UPRES '
'ANTPRICH4 ',
'ANTSGMMODCH4 ',
'ANTCH4 ',
'ANTRESCH4 ',
'ANTPRIN2O ',
'ANTSGMMODN2O ',
'ANTN2O ',
'ANTRESN2O ',
'CONCH4PRI ',
'CONCH4SGMMOD ',
'CONCH4POS ',
'CONCH4RES ',
'CONN2OPRI ',
'CONN2OSGMMOD ',
'CONN2OPOS ',
'CONN2ORES ',
'RADTTLPRI ',
'RADMISSGMMOD ',
'RADTTLPOS ',
'RADTTLRES ',
'T2MPRI ',
'T2MSGMMOD ',
'T2MPOS ',
'T2MRES '/;
LOOP(T, PUT T.TL:4,
CO2FFPRI(T):12:6,
CO2FFSGMMOD.L(T):12:6,
CO2FF.L(T):12:6,
CO2FFRES.L(T):12:6,
CO2LUPRI(T):12:6,
CO2LUSGMMOD.L(T):12:6,
CO2LU.L(T):12:6,
CO2LURES.L(T):12:6,
CONCO2PRI(T):12:6,
CONCO2SGMMOD.L(T):12:6,
CON.L(T,'CO2'):12:6,
CONCO2RES.L(T):12:6,
CO2OCNUPANTPRI(T):12:6,
CO2OCNUPANTSGM(T):12:6,
CO2OCNUPANT.L(T):12:6,
CO2OCNUPANTRES.L(T):12:6,
CO2LNDUPANTPRI(T):12:6,
CO2LNDUPANTSGM(T):12:6,
CO2LNDUPANT.L(T):12:6,
CO2LNDUPANTRES.L(T):12:6,
ANTPRI.L(T,'CH4'):8:2,
ANTSGMMOD.L(T,'CH4'):8:2,
ANT.L(T,'CH4'):9:3,
ANTRES.L(T,'CH4'):9:3,
ANTPRI.L(T,'N2O'):9:3,
ANTSGMMOD.L(T,'N2O'):9:4,
ANT.L(T,'N2O'):9:4,
ANTRES.L(T,'N2O'):9:4,
CONCH4PRI(T):8:2,
CONCH4SGMMOD.L(T):8:1,
CON.L(T,'CH4'):8:1,
CONCH4RES.L(T):8:2,
CONN2OPRI(T):8:2,
CONN2OSGMMOD.L(T):8:1,
CON.L(T,'N2O'):8:1,
CONN2ORES.L(T):8:2,
RADTTLPRI.L(T):10:5,
RADMISSGMMOD.L(T):10:5,
RADTTL.L(T):10:5,
RADMISRES.L(T):10:5,
T2MPRI.L(T):10:5,
T2MSGMMOD.L(T):10:5,
T2M.L(T):10:5,
T2MRES.L(T):10:5/;);


FILE OUT_PAST_ADD1 /out_past_add1.dat/;
OUT_PAST_ADD1.AP=0;
OUT_PAST_ADD1.PW=1000;
PUT OUT_PAST_ADD1;
PUT
'YEAR ',
'COC1 ',
'COC2 ',
'COC3 ',
'COC4 ',
'COC1ATMBAC ',
'COC1MIXBAC ',
'COC1ATM ',
'COC1MIX ',
'COC1ALL ',
'PH ',
'DIC ',
'CO2AQ ',
'HCO3 ',
'CO32 ',
'FRCO2AQ ',
'FRHCO3 ',
'FRCO32 ',
'REVELLE ',
'FLXCOC1 ',
'FLXCOC2 ',
'FLXCOC3 ',
'FLXCOC4 ',
'CTRREL1 ',
'CTRREL2 ',
'CTRREL3 ',
'CTRREL4 ',
'NPPBAC1 ',
'NPPBAC2 ',
'NPPBAC3 ',
'NPPBAC4 ',
'CO2FRT1 ',
'CO2FRT2 ',
'CO2FRT3 ',
'CO2FRT4 ',
'HTRRES1 ',
'HTRRES2 ',
'HTRRES3 ',
'HTRRES4 ',
'FLXCTR1 ',
'FLXCTR2 ',
'FLXCTR3 ',
'FLXCTR4 ',
'TNPPFAC ',
'TRESFAC ',
'Q10EFF ',
'CONCO2PRI ',
'CONCO2INT ',
'CONCO2 ',
'CONCO2RES ',
'CONCO2RESWTENSO ',
'ANTCO2 ',
'CO2FFPRI ',
'CO2FFPOS ',
'CO2LUPRI ',
'CO2LUPOS ',
'CO2OCNUPANT ',
'CO2LNDUPANT ',
'DCONCO2ANT ',
'DCONCO2NAT ',
'DCONCO2TTL ',
'DCONCO2ENSO '/;
LOOP(T, PUT T.TL:4,
COC.L(T,'1'):8:3,
COC.L(T,'2'):8:3,
COC.L(T,'3'):8:3,
COC.L(T,'4'):8:3,
COC1ATMBAC.L:6:1,
COC1MIXBAC.L:6:1,
COC1ATM.L(T):8:3,
COC1MIX.L(T):8:3,
COC1ALL.L(T):10:3,
PH.L(T):7:4,
DIC.L(T):11:8,
CO2AQ.L(T):13:10,
HCO3.L(T):11:8,
CO32.L(T):11:8,
FRCO2AQ.L(T):9:6,
FRHCO3.L(T):9:6,
FRCO32.L(T):9:6,
REVELLE.L(T):8:4,
FLXCOC1.L(T):10:6,
FLXCOC2.L(T):10:6,
FLXCOC3.L(T):10:6,
FLXCOC4.L(T):10:6,
CTRREL.L(T,'1'):9:2,
CTRREL.L(T,'2'):9:2,
CTRREL.L(T,'3'):9:2,
CTRREL.L(T,'4'):9:2,
NPPBAC.L(T,'1'):10:5,
NPPBAC.L(T,'2'):10:5,
NPPBAC.L(T,'3'):10:5,
NPPBAC.L(T,'4'):10:5,
CO2FRT.L(T,'1'):10:5,
CO2FRT.L(T,'2'):10:5,
CO2FRT.L(T,'3'):10:5,
CO2FRT.L(T,'4'):10:5,
HTRRES.L(T,'1'):10:3,
HTRRES.L(T,'2'):10:3,
HTRRES.L(T,'3'):10:3,
HTRRES.L(T,'4'):10:3,
FLXCTR.L(T,'1'):9:5,
FLXCTR.L(T,'2'):9:5,
FLXCTR.L(T,'3'):9:5,
FLXCTR.L(T,'4'):9:5,
TNPPFAC.L(T):8:4,
TRESFAC.L(T):8:4,
Q10EFF.L(T):7:4,
CONCO2PRI(T):10:3,
CONCO2INT.L(T):10:3,
CON.L(T,'CO2'):10:3,
CONCO2RES.L(T):9:4,
CONCO2RESWTENSO.L(T):9:4,
ANT.L(T,'CO2'):10:5,
CO2FFPRI(T):10:5,
CO2FF.L(T):10:5,
CO2LUPRI(T):10:5,
CO2LU.L(T):10:5,
CO2OCNUPANT.L(T):10:5,
CO2LNDUPANT.L(T):10:5,
DCONCO2ANT.L(T):10:5,
DCONCO2NAT.L(T):10:5,
DCONCO2TTL.L(T):10:5,
DCONCO2ENSO.L(T):10:5/;);


FILE OUT_PAST_ADD2 /out_past_add2.dat/;
OUT_PAST_ADD2.AP=0;
OUT_PAST_ADD2.PW=1000;
PUT OUT_PAST_add2;
PUT
'YEAR ',
'RADCO2 ',
'RADCH4 ',
'RADN2O ',
'RADHAL ',
'RADODS ',
'RADSF6 ',
'RADO3 ',
'RADSO2 ',
'RADCRBAER ',
'RADAERIND ',
'RADH2OSTR ',
'RADVOL ',
'RADSOL ',
'RADMIS ',
'RADTTL ',
'RADANTL ',
'RADANTO ',
'RADSOLL ',
'RADSOLO ',
'RADTTLL ',
'RADTTLO ',
'RADTTL ',
'TAL ',
'TSS ',
'GMT '/;
LOOP(T, PUT T.TL:4,
RAD.L(T,'CO2'):10:5,
RAD.L(T,'CH4'):10:5,
RAD.L(T,'N2O'):10:5,
RADHAL.L(T):10:5,
RADODS.L(T):10:5,
RAD.L(T,'SF6'):10:5,
RADO3.L(T):10:5,
RAD.L(T,'SO2'):10:5,
RAD.L(T,'CRBAER'):10:5,
RAD.L(T,'AERIND'):10:5,
RAD.L(T,'H2OSTR'):10:5,
RADVOL(T):10:5,
RADSOL.L(T):10:5,
RADMIS.L(T):10:5,
RADTTL.L(T):10:5,
RADANTL.L(T):10:5,
RADANTO.L(T):10:5,
RADSOLL.L(T):10:5,
RADSOLO.L(T):10:5,
RADTTLL.L(T):10:5,
RADTTLO.L(T):10:5,
RADTTL.L(T):10:5,
TAL.L(T):10:5,
TSS.L(T):10:5,
GMT.L(T):10:5/;);


*** File output to check the residuals----------------------------------------------------------------------------------

FILE OUT_PAST_RESIDUAL /out_past_residual.dat/;
OUT_PAST_RESIDUAL.AP=0;
PUT OUT_PAST_RESIDUAL;
PUT
'YEAR ',
'EMICO2FF ',
'EMICO2LU ',
'EMICH4ANT ',
'EMIN2OANT ',
'MISFOR ',
'UPCO2OCN ',
'UPCO2LND ',
'CONCO2 ',
'CONCH4 ',
'CONN2O ',
'TEMP '/;
LOOP(T, PUT T.TL:4,
CO2FFWSQRES.L(T):15:8,
CO2LUWSQRES.L(T):15:8,
ANTWSQRES.L(T,'CH4'):15:8,
ANTWSQRES.L(T,'N2O'):15:8,
RADMISWSQRES.L(T):15:8,
CO2OCNUPANTWSQRES.L(T):15:8,
CO2LNDUPANTWSQRES.L(T):15:8,
CONCO2WSQRES.L(T):15:8,
CONCH4WSQRES.L(T):15:8,
CONN2OWSQRES.L(T):15:8,
T2MWSQRES.L(T):15:8/;);


*** File outputs to display results (RCMIP) ----------------------------------------------------------------------------

FILE OUT_PAST_RCMIP /out_past_rcmip.dat/;
OUT_PAST_RCMIP.AP=0;
OUT_PAST_RCMIP.PW=1000;
PUT OUT_PAST_RCMIP;
PUT
'YEAR ',
'CONCO2 ',
'CONCH4 ',
'CONN2O ',
'T2M ',
'CUMCO2 ',
'ANTCO2 ',
'ANTCH4 ',
'ANTN2O ',
'ANTNOx ',
'ANTCO ',
'ANTVOC ',
'ANTSO2 ',
'RADTTL ',
'RADANT ',
'RADAER ',
'RADCO2 ',
'RADCH4 ',
'RADN2O ',
'pH '/;
LOOP(T, PUT T.TL:4,
CON.L(T,'CO2'):9:2,
CON.L(T,'CH4'):9:2,
CON.L(T,'N2O'):9:2,
T2M.L(T):9:4,
CUMCO2.L(T):8:2,
ANT.L(T,'CO2'):10:4,
ANT.L(T,'CH4'):10:2,
ANT.L(T,'N2O'):8:2,
ANT.L(T,'NOx'):8:2,
ANT.L(T,'CO'):8:2,
ANT.L(T,'VOC'):8:2,
ANT.L(T,'SO2'):8:2,
RADTTL.L(T):9:4,
RADANT.L(T):9:4,
RADAER.L(T):9:4,
RAD.L(T,'CO2'):9:4,
RAD.L(T,'CH4'):9:4,
RAD.L(T,'N2O'):9:4,
PH.L(T):9:4/;);
